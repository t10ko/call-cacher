/*! call-cacher - v1.0.0 - 2016-10-02
 * https://github.com/t10ko/call-cacher
 * Copyright (c) 2016 Tigran Atayan; License: GPL-3.0 */




!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("object"==typeof exports?exports:t).CallCacher=e()}(this,function(){"use strict";function t(t,n){return new e(t,n)}function e(t,e){var n=this;this.stack=[],this.execute=function(){if(n.isReady)return n.handler.apply(this,arguments);if(n.cancelled){if(n.canceller)return n.canceller.apply(this,arguments)}else n.stack.push({that:this,args:arguments});return n.returnValue},this.handler=t,this.returnValue=e}var n=t,r=function(){var t=Function.prototype;return function(e){return"function"==typeof e&&e!=t}}();return function(t){t.stack=null,t.handler=null,t.execute=null,t.returnValue=null,t.isReady=!1,t.cancelled=!1,t.canceller=null,t.ready=function(t){if(this.isReady||this.cancelled)return!1;this.isReady=!0;for(var e=[],n=this.stack.length,r=0;r<n;r++){var l=this.stack[r];t&&t.apply(l.that,l.args),e.push(this.handler.apply(l.that,l.args))}return this.stack=null,e},t.cancel=function(t){return!this.isReady&&!this.cancelled&&(this.cancelled=!0,r(t)?this.canceller=t:this.returnValue=t,this.stack=null,!0)},t.constructor=e,e.prototype=t}(e.prototype),n});